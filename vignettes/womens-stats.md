Womens’ AFL Stats
================
Oscar Lane <lane.oscar@gmail.com>
2018-10-12

### Authentication

The AFL Stats website requires a cookie to retrieve data through GET
requests. The `get_womens_cookie()` function retrieves this cookie as a
string. It requires no arguments.

``` r
library(fitzRoy)
library(dplyr)
library(magrittr)
cookie <- get_aflw_cookie()
cookie
#> [1] "19329eee6e090f216b2c4c2ca39edfb6"
```

### Round list

The `get_rounds` function looks for available data. There is currently
only 2017 and 2018 data present, but the function will look for all
years up to 2100. (This is built as a while loop so it will cut off if
it finds that it is getting null responses, as it does for 2019 onwards
at the moment, but it should be relatively future-proof, given the site
API doesn’t change.)

``` r
rounds <- get_aflw_rounds(cookie)
glimpse(rounds)
#> Observations: 16
#> Variables: 12
#> $ name           <chr> "2017 NAB AFLW Competition", "2017 NAB AFLW Com...
#> $ id             <chr> "CD_S2017264", "CD_S2017264", "CD_S2017264", "C...
#> $ roundPhase     <chr> "SCHEDULED", "SCHEDULED", "SCHEDULED", "SCHEDUL...
#> $ currentRoundId <chr> "CD_R201726408", "CD_R201726408", "CD_R20172640...
#> $ name1          <chr> "Round 1", "Round 2", "Round 3", "Round 4", "Ro...
#> $ year           <chr> "2017", "2017", "2017", "2017", "2017", "2017",...
#> $ season         <chr> "09632b7a20929510VgnVCM100000ac05030aRCRD", "09...
#> $ roundId        <chr> "CD_R201726401", "CD_R201726402", "CD_R20172640...
#> $ abbreviation   <chr> "Rd 1", "Rd 2", "Rd 3", "Rd 4", "Rd 5", "Rd 6",...
#> $ competitionId  <chr> "CD_S2017264", "CD_S2017264", "CD_S2017264", "C...
#> $ roundNumber    <int> 1, 2, 3, 4, 5, 6, 7, 8, 1, 2, 3, 4, 5, 6, 7, 8
#> $ guid           <chr> "61732b7a20929510VgnVCM100000ac05030aRCRD", "ce...
```

There are 16 observations, as there have been two seasons with 8 rounds
each.

### Match data

We can use the `get_aflw_match_data()` function to retrieve match data
for all matches. Under the hood, this works by taking the `roundId` in
the round list above, and using the internal `get_match_data()`
function.

This could be extended to take a year argument, so that only games in
specified years are downloaded. There are only two seasons so far in the
womens’ league, however, so we probably do want all the data\!

``` r
match_data <- get_aflw_match_data()
glimpse(match_data)
#> Observations: 58
#> Variables: 30
#> $ Match.Id             <chr> "CD_M20172640101", "CD_M20172640102", "CD...
#> $ Round.Id             <chr> "CD_R201726401", "CD_R201726401", "CD_R20...
#> $ Competition.Id       <chr> "CD_S2017264", "CD_S2017264", "CD_S201726...
#> $ Venue                <chr> "Ikon Park", "Thebarton Oval", "VU Whitte...
#> $ Local.Start.Time     <dttm> 2017-02-03 19:45:00, 2017-02-04 16:35:00...
#> $ Round.Number         <int> 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4,...
#> $ Round.Abbreviation   <chr> "Rd 1", "Rd 1", "Rd 1", "Rd 1", "Rd 2", "...
#> $ Weather.Type         <chr> "CLEAR_NIGHT", "RAIN", "RAIN", "RAIN", "C...
#> $ Weather.Description  <chr> "Clear", "Rain at times", "Partly cloudy"...
#> $ Temperature          <dbl> 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 1...
#> $ Home.Team            <chr> "Carlton", "Adelaide Crows", "Western Bul...
#> $ Home.Goals           <int> 7, 7, 6, 1, 2, 7, 4, 3, 7, 4, 4, 2, 6, 6,...
#> $ Home.Behinds         <int> 4, 6, 8, 4, 11, 5, 1, 5, 1, 3, 5, 5, 6, 7...
#> $ Home.Points          <int> 46, 48, 44, 10, 23, 47, 25, 23, 43, 27, 2...
#> $ Home.Left.Behinds    <int> 1, 2, 2, 1, 2, 1, 0, 0, 0, 0, 3, 2, 2, 5,...
#> $ Home.Right.Behinds   <int> 2, 2, 4, 2, 5, 2, 1, 1, 0, 2, 1, 0, 2, 1,...
#> $ Home.Left.Posters    <int> 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0,...
#> $ Home.Right.Posters   <int> 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0,...
#> $ Home.Rushed.Behinds  <int> 1, 2, 2, 1, 3, 2, 0, 2, 1, 1, 0, 3, 1, 1,...
#> $ Home.Touched.Behinds <int> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
#> $ Away.Team            <chr> "Collingwood", "GWS Giants", "Fremantle",...
#> $ Away.Goals           <int> 1, 1, 1, 4, 7, 5, 7, 5, 6, 3, 6, 2, 5, 1,...
#> $ Away.Behinds         <int> 5, 6, 6, 1, 6, 4, 2, 6, 7, 5, 7, 2, 6, 3,...
#> $ Away.Points          <int> 11, 12, 12, 25, 48, 34, 44, 36, 43, 23, 4...
#> $ Away.Left.Behinds    <int> 0, 1, 2, 1, 2, 0, 0, 1, 0, 1, 1, 0, 0, 1,...
#> $ Away.Right.Behinds   <int> 3, 4, 3, 0, 2, 3, 1, 3, 3, 3, 5, 1, 1, 1,...
#> $ Away.Left.Posters    <int> 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 2, 1,...
#> $ Away.Right.Posters   <int> 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0,...
#> $ Away.Rushed.Behinds  <int> 1, 1, 1, 0, 2, 1, 0, 1, 2, 1, 0, 0, 2, 0,...
#> $ Away.Touched.Behinds <int> 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0,...
```

### Detailed stats

The `get_aflw_detailed_data()` can be used to return more detailed data
than the match data shown above. It takes a vector of match IDs as an
argument. For example, let’s say we want detailed stats for the last 10
games in `match_data` above. Then we would do:

``` r
last10 <- tail(match_data, 10) %>% 
  pull(Match.Id)
last10
#>  [1] "CD_M20182640504" "CD_M20182640601" "CD_M20182640602"
#>  [4] "CD_M20182640603" "CD_M20182640604" "CD_M20182640701"
#>  [7] "CD_M20182640702" "CD_M20182640703" "CD_M20182640704"
#> [10] "CD_M20182640801"
```

``` r
detailed_data <- get_aflw_detailed_data(matchids = last10, cookie)
detailed_data %>% glimpse
#> Observations: 10
#> Variables: 191
#> $ Match.Id                                                    <chr> "C...
#> $ Round.Id                                                    <chr> "C...
#> $ Competition.Id                                              <chr> "C...
#> $ away.stats.averages.behinds                                 <dbl> 45...
#> $ away.stats.averages.bounces                                 <dbl> 3....
#> $ away.stats.averages.clangers                                <dbl> 32...
#> $ away.stats.averages.clearances.centreClearances             <dbl> 4....
#> $ away.stats.averages.clearances.stoppageClearances           <dbl> 17...
#> $ away.stats.averages.clearances.totalClearances              <dbl> 22...
#> $ away.stats.averages.contestedMarks                          <dbl> 4....
#> $ away.stats.averages.contestedPossessions                    <dbl> 93...
#> $ away.stats.averages.disposalEfficiency                      <dbl> 60...
#> $ away.stats.averages.disposals                               <dbl> 19...
#> $ away.stats.averages.dreamTeamPoints                         <dbl> 91...
#> $ away.stats.averages.freesAgainst                            <dbl> 13...
#> $ away.stats.averages.freesFor                                <dbl> 14...
#> $ away.stats.averages.goalAccuracy                            <dbl> 42...
#> $ away.stats.averages.goalAssists                             <dbl> 3....
#> $ away.stats.averages.goalEfficiency                          <dbl> 21...
#> $ away.stats.averages.goals                                   <dbl> 6....
#> $ away.stats.averages.handballs                               <dbl> 59...
#> $ away.stats.averages.hitouts                                 <dbl> 22...
#> $ away.stats.averages.inside50s                               <dbl> 28...
#> $ away.stats.averages.intercepts                              <dbl> 51...
#> $ away.stats.averages.interchangeCounts.interchangeCap        <dbl> 0,...
#> $ away.stats.averages.interchangeCounts.interchangeCountQ1    <dbl> 0,...
#> $ away.stats.averages.interchangeCounts.interchangeCountQ2    <dbl> 0,...
#> $ away.stats.averages.interchangeCounts.interchangeCountQ3    <dbl> 0,...
#> $ away.stats.averages.interchangeCounts.interchangeCountQ4    <dbl> 0,...
#> $ away.stats.averages.interchangeCounts.totalInterchangeCount <dbl> 0,...
#> $ away.stats.averages.kicks                                   <dbl> 13...
#> $ away.stats.averages.lastUpdated                             <dttm> 2...
#> $ away.stats.averages.marks                                   <dbl> 42...
#> $ away.stats.averages.marksInside50                           <dbl> 7....
#> $ away.stats.averages.metresGained                            <dbl> NA...
#> $ away.stats.averages.onePercenters                           <dbl> 23...
#> $ away.stats.averages.ranking                                 <dbl> NA...
#> $ away.stats.averages.ratingPoints                            <dbl> NA...
#> $ away.stats.averages.rebound50s                              <dbl> 20...
#> $ away.stats.averages.scoreInvolvements                       <dbl> NA...
#> $ away.stats.averages.shotEfficiency                          <dbl> 50...
#> $ away.stats.averages.shotsAtGoal                             <dbl> 14...
#> $ away.stats.averages.superGoals                              <dbl> NA...
#> $ away.stats.averages.tackles                                 <dbl> 58...
#> $ away.stats.averages.tacklesInside50                         <dbl> 9....
#> $ away.stats.averages.totalPossessions                        <dbl> 18...
#> $ away.stats.averages.turnovers                               <dbl> 51...
#> $ away.stats.averages.uncontestedPossessions                  <dbl> 95...
#> $ away.stats.totals.behinds                                   <dbl> 7,...
#> $ away.stats.totals.bounces                                   <dbl> 0,...
#> $ away.stats.totals.clangers                                  <dbl> 36...
#> $ away.stats.totals.clearances.centreClearances               <dbl> 8,...
#> $ away.stats.totals.clearances.stoppageClearances             <dbl> 12...
#> $ away.stats.totals.clearances.totalClearances                <dbl> 20...
#> $ away.stats.totals.contestedMarks                            <dbl> 6,...
#> $ away.stats.totals.contestedPossessions                      <dbl> 93...
#> $ away.stats.totals.disposalEfficiency                        <dbl> 57...
#> $ away.stats.totals.disposals                                 <dbl> 15...
#> $ away.stats.totals.dreamTeamPoints                           <dbl> 71...
#> $ away.stats.totals.freesAgainst                              <dbl> 14...
#> $ away.stats.totals.freesFor                                  <dbl> 20...
#> $ away.stats.totals.goalAccuracy                              <dbl> 36...
#> $ away.stats.totals.goalAssists                               <dbl> 2,...
#> $ away.stats.totals.goalEfficiency                            <dbl> 23...
#> $ away.stats.totals.goals                                     <dbl> 7,...
#> $ away.stats.totals.handballs                                 <dbl> 43...
#> $ away.stats.totals.hitouts                                   <dbl> 16...
#> $ away.stats.totals.inside50s                                 <dbl> 30...
#> $ away.stats.totals.intercepts                                <dbl> 45...
#> $ away.stats.totals.interchangeCounts.interchangeCap          <dbl> 0,...
#> $ away.stats.totals.interchangeCounts.interchangeCountQ1      <dbl> 0,...
#> $ away.stats.totals.interchangeCounts.interchangeCountQ2      <dbl> 0,...
#> $ away.stats.totals.interchangeCounts.interchangeCountQ3      <dbl> 0,...
#> $ away.stats.totals.interchangeCounts.interchangeCountQ4      <dbl> 0,...
#> $ away.stats.totals.interchangeCounts.totalInterchangeCount   <dbl> 0,...
#> $ away.stats.totals.kicks                                     <dbl> 11...
#> $ away.stats.totals.lastUpdated                               <dttm> 2...
#> $ away.stats.totals.marks                                     <dbl> 30...
#> $ away.stats.totals.marksInside50                             <dbl> 7,...
#> $ away.stats.totals.metresGained                              <dbl> NA...
#> $ away.stats.totals.onePercenters                             <dbl> 21...
#> $ away.stats.totals.ranking                                   <dbl> NA...
#> $ away.stats.totals.ratingPoints                              <dbl> NA...
#> $ away.stats.totals.rebound50s                                <dbl> 15...
#> $ away.stats.totals.scoreInvolvements                         <dbl> NA...
#> $ away.stats.totals.shotEfficiency                            <dbl> 63...
#> $ away.stats.totals.shotsAtGoal                               <dbl> 19...
#> $ away.stats.totals.superGoals                                <dbl> NA...
#> $ away.stats.totals.tackles                                   <dbl> 37...
#> $ away.stats.totals.tacklesInside50                           <dbl> 3,...
#> $ away.stats.totals.totalPossessions                          <dbl> 15...
#> $ away.stats.totals.turnovers                                 <dbl> 41...
#> $ away.stats.totals.uncontestedPossessions                    <dbl> 64...
#> $ away.team.teamAbbr                                          <chr> "W...
#> $ away.team.teamId                                            <chr> "C...
#> $ away.team.teamName                                          <chr> "W...
#> $ away.team.teamNickname                                      <chr> "B...
#> $ home.stats.averages.behinds                                 <dbl> 29...
#> $ home.stats.averages.bounces                                 <dbl> 2....
#> $ home.stats.averages.clangers                                <dbl> 46...
#> $ home.stats.averages.clearances.centreClearances             <dbl> 5....
#> $ home.stats.averages.clearances.stoppageClearances           <dbl> 12...
#> $ home.stats.averages.clearances.totalClearances              <dbl> 17...
#> $ home.stats.averages.contestedMarks                          <dbl> 6....
#> $ home.stats.averages.contestedPossessions                    <dbl> 91...
#> $ home.stats.averages.disposalEfficiency                      <dbl> 62...
#> $ home.stats.averages.disposals                               <dbl> 19...
#> $ home.stats.averages.dreamTeamPoints                         <dbl> 93...
#> $ home.stats.averages.freesAgainst                            <dbl> 18...
#> $ home.stats.averages.freesFor                                <dbl> 14...
#> $ home.stats.averages.goalAccuracy                            <dbl> 48...
#> $ home.stats.averages.goalAssists                             <dbl> 3....
#> $ home.stats.averages.goalEfficiency                          <dbl> 24...
#> $ home.stats.averages.goals                                   <dbl> 6....
#> $ home.stats.averages.handballs                               <dbl> 60...
#> $ home.stats.averages.hitouts                                 <dbl> 24...
#> $ home.stats.averages.inside50s                               <dbl> 24...
#> $ home.stats.averages.intercepts                              <dbl> 55...
#> $ home.stats.averages.interchangeCounts.interchangeCap        <dbl> 0,...
#> $ home.stats.averages.interchangeCounts.interchangeCountQ1    <dbl> 0,...
#> $ home.stats.averages.interchangeCounts.interchangeCountQ2    <dbl> 0,...
#> $ home.stats.averages.interchangeCounts.interchangeCountQ3    <dbl> 0,...
#> $ home.stats.averages.interchangeCounts.interchangeCountQ4    <dbl> 0,...
#> $ home.stats.averages.interchangeCounts.totalInterchangeCount <dbl> 0,...
#> $ home.stats.averages.kicks                                   <dbl> 13...
#> $ home.stats.averages.lastUpdated                             <dttm> 2...
#> $ home.stats.averages.marks                                   <dbl> 48...
#> $ home.stats.averages.marksInside50                           <dbl> 5....
#> $ home.stats.averages.metresGained                            <dbl> NA...
#> $ home.stats.averages.onePercenters                           <dbl> 24...
#> $ home.stats.averages.ranking                                 <dbl> NA...
#> $ home.stats.averages.ratingPoints                            <dbl> NA...
#> $ home.stats.averages.rebound50s                              <dbl> 23...
#> $ home.stats.averages.scoreInvolvements                       <dbl> NA...
#> $ home.stats.averages.shotEfficiency                          <dbl> 50...
#> $ home.stats.averages.shotsAtGoal                             <dbl> 12...
#> $ home.stats.averages.superGoals                              <dbl> NA...
#> $ home.stats.averages.tackles                                 <dbl> 58...
#> $ home.stats.averages.tacklesInside50                         <dbl> 6....
#> $ home.stats.averages.totalPossessions                        <dbl> 19...
#> $ home.stats.averages.turnovers                               <dbl> 56...
#> $ home.stats.averages.uncontestedPossessions                  <dbl> 99...
#> $ home.stats.totals.behinds                                   <dbl> 5,...
#> $ home.stats.totals.bounces                                   <dbl> 2,...
#> $ home.stats.totals.clangers                                  <dbl> 35...
#> $ home.stats.totals.clearances.centreClearances               <dbl> 6,...
#> $ home.stats.totals.clearances.stoppageClearances             <dbl> 14...
#> $ home.stats.totals.clearances.totalClearances                <dbl> 20...
#> $ home.stats.totals.contestedMarks                            <dbl> 6,...
#> $ home.stats.totals.contestedPossessions                      <dbl> 77...
#> $ home.stats.totals.disposalEfficiency                        <dbl> 61...
#> $ home.stats.totals.disposals                                 <dbl> 15...
#> $ home.stats.totals.dreamTeamPoints                           <dbl> 83...
#> $ home.stats.totals.freesAgainst                              <dbl> 20...
#> $ home.stats.totals.freesFor                                  <dbl> 14...
#> $ home.stats.totals.goalAccuracy                              <dbl> 54...
#> $ home.stats.totals.goalAssists                               <dbl> 2,...
#> $ home.stats.totals.goalEfficiency                            <dbl> 27...
#> $ home.stats.totals.goals                                     <dbl> 6,...
#> $ home.stats.totals.handballs                                 <dbl> 38...
#> $ home.stats.totals.hitouts                                   <dbl> 43...
#> $ home.stats.totals.inside50s                                 <dbl> 22...
#> $ home.stats.totals.intercepts                                <dbl> 41...
#> $ home.stats.totals.interchangeCounts.interchangeCap          <dbl> 0,...
#> $ home.stats.totals.interchangeCounts.interchangeCountQ1      <dbl> 0,...
#> $ home.stats.totals.interchangeCounts.interchangeCountQ2      <dbl> 0,...
#> $ home.stats.totals.interchangeCounts.interchangeCountQ3      <dbl> 0,...
#> $ home.stats.totals.interchangeCounts.interchangeCountQ4      <dbl> 0,...
#> $ home.stats.totals.interchangeCounts.totalInterchangeCount   <dbl> 0,...
#> $ home.stats.totals.kicks                                     <dbl> 11...
#> $ home.stats.totals.lastUpdated                               <dttm> 2...
#> $ home.stats.totals.marks                                     <dbl> 43...
#> $ home.stats.totals.marksInside50                             <dbl> 1,...
#> $ home.stats.totals.metresGained                              <dbl> NA...
#> $ home.stats.totals.onePercenters                             <dbl> 20...
#> $ home.stats.totals.ranking                                   <dbl> NA...
#> $ home.stats.totals.ratingPoints                              <dbl> NA...
#> $ home.stats.totals.rebound50s                                <dbl> 21...
#> $ home.stats.totals.scoreInvolvements                         <dbl> NA...
#> $ home.stats.totals.shotEfficiency                            <dbl> 50...
#> $ home.stats.totals.shotsAtGoal                               <dbl> 11...
#> $ home.stats.totals.superGoals                                <dbl> NA...
#> $ home.stats.totals.tackles                                   <dbl> 61...
#> $ home.stats.totals.tacklesInside50                           <dbl> 8,...
#> $ home.stats.totals.totalPossessions                          <dbl> 14...
#> $ home.stats.totals.turnovers                                 <dbl> 45...
#> $ home.stats.totals.uncontestedPossessions                    <dbl> 70...
#> $ home.team.teamAbbr                                          <chr> "C...
#> $ home.team.teamId                                            <chr> "C...
#> $ home.team.teamName                                          <chr> "C...
#> $ home.team.teamNickname                                      <chr> "M...
```
